# DATA ANALYTICS PORTFOLIO

# EXCEL PROJECTS

## Project Overview

# Project 1

**Title:** [Retail Sales Data](https://github.com/Dennistheanalyst/dennistheanalyst.github.io/blob/main/retail_sales_data%20Excel.xlsx)

**Tools Used:** Microsoft Excel (Power Query for data cleaning, Coditional Formating, Pivot Tables, Slicers, use of slicers, Pivot Charts, Timeline, shapes, Shape format)

**Project Description:** This project involved analysing sales data of a company to identify trends and patterns in sales performance for 2015 and 2016. It is designed to provide a comprehensive overview of key performance metrics. This dashboard allows stakeholders to easily monitor and analyze the company’s performance across different regions, states, and time periods. The dashboard includes the following features:

KPIs : 

- **Total Revenue : Total revenue generated by the company.
- **Total Profit : Total Profit made by the Company.
- **Total Cost : Sum of all expenses accrued by the company.
- **Total Quantity : Total number of goods produced by t he company.
- **Profit/Revenue by Country: Visual representation of profits and revenue broken down by each country.
- **Total Units Sold per Month: A monthly breakdown of the total units sold, providing insights into sales trends over time.
- **Profit/Revenue by Month: Displays the monthly profit and revenue, allowing for easy comparison of profitability throughout the year.
- **Total Revenue by Country and by various states: Highlights the total revenue generated in each country and states, showcasing the performance in different markets.

Additionally, the dashboard includes interactive slicers and timeline for:
- **Month: Filter the data to view performance for a specific month or range of months.
- **Country: Focus on specific countries to analyze regional performance.
- **Gender: Drill down into the performance of each gender.

## Project Objectives
1. **Data Cleaning - Identify and handle missing or null values to ensure data accuracy and reliability.
2. **Exploratory Data Analysis - Utilization of pivot tables for exploratory data analysis
3. **Insights and analysis - Leveraging Excel Dashboard Design for Data Analysis  and to provide key patterns, trends, and relationships within the dataset


## Project Structure:

### Data Cleaning

- **Remove blanks and Null values**: Identify Null values in data and make sure that there values are cleared.
- **Null Value Check**: Check for any null values in the dataset and delete records with missing data.
- **Remove duplicates**: Remove duplicates value to avoid inflation of figure and t maintain data accuracy.
- **Standardize Data Formatting**: Remove extra spaces using the TRIM function to ensure consistency, Retrieve data from related sources using functions like XLOOKUP and INDEX MATCH for efficient data mapping, Refine data categorization with the IF statement to standardize values within a specific column.
- **Convert Data into Tables for Easy Analysis

## Data Analysis
- **Utilization of pivot tables for data analysis and Identify KPIs 


### 3. Findings
- **Seasonal Trends - Identified sales and profit trends that align with seasonal events and market cycles, providing valuable insights for strategic business planning. These findings help optimize inventory management, promotional campaigns, and resource allocation to maximize profitability during peak seasons and mitigate downturns during slower periods.
- **Top performing Countries - Germany leads as the top-performing country in sales with 42%, followed by the United States at 31%, the UK at 15%, and France at 12%. To maintain strong sales in top-performing regions, strategies such as personalized promotions, loyalty programs, and optimizing the supply chain should be prioritized. For regions with lower performance, like France, focusing on targeted marketing, boosting customer engagement, and expanding distribution channels will be essential to drive sales growth.
- **Sales Volatility - Conducted an in-depth analysis of monthly sales fluctuations to identify seasonal trends, demand patterns, and potential market shifts. These insights enable data-driven decision-making, allowing the business to optimize inventory management, refine marketing strategies, and adjust sales tactics to align with changing consumer behaviors and market conditions.
- **Regional Profitability - identify performing regions and underperforming regions and suggest strategies to increase profitability in theses regions
- **Customer Demographics - This project analyzes customer performance based on key attributes such as age and gender, and identifies the products preferred by customers based on these demographic factors.


## Reports
- **The analysis reveals that the United States leads in sales, with California being the top-performing state, followed by England during this period. Therefore, if stakeholders allocate resources for targeted marketing campaigns in these regions, there is potential for a 12% increase in sales within the next 3 months.
- **There is a strong need to focus on retaining existing customers in the leading countries rather than seeking new ones. This approach will help reduce costs while driving higher sales and fostering long-term customer loyalty.
- **Sales in underperforming regions could increase by 10% with the implementation of strategies focused on enhancing customer service. Additionally, management should prioritize reducing operational costs in these regions to improve overall profitability and efficiency.
- **The leading product favored across these four countries is Mountain Bikes. Given the data indicating a growing demand for this product, it is essential to ensure a consistent supply of Mountain Bikes in all these regions to meet customer needs and capitalize on the rising demand.
- **The analysis highlights that May, June, and December are the peak periods when sales for all products are maximized. Therefore, it is crucial to make adequate preparations ahead of these peak periods to meet customer demand and fully capitalize on sales opportunities.


## Conclusion
This project offers a comprehensive guide to advanced Excel techniques for data analysts in the retail sales industry. It covers data cleaning, exploratory data analysis with pivot tables, and visualizing insights through interactive dashboards. The objective is to help retail companies enhance sales performance and refine strategies based on monthly trends and data-driven analysis.


**Dashboard Overview:** 
![Sales_Dashboard](Retail_Sales_Dashboard.JPG)

# Project 2

## Project Overview

**Title:** [Coffee Order Dashboard](coffeeOrdersData.xlsx)

**Tools Used:** Microsoft Excel (Excel Functions - if statement,xlookup,vlookup,index-match,remove duplicates, Pivot Tables, Slicers, use of slicers, Pivot Charts, Timeline, shapes, Shape format)

**Project Description:** This project provides an in-depth analysis of coffee sales data from a coffee company, offering valuable insights into sales performance, customer behavior, and regional market trends. The analysis focuses on identifying patterns in sales fluctuations over a given year, highlighting periods of growth and decline. Additionally, it examines regional sales distribution to determine which areas contribute the most to overall revenue.
A key aspect of this analysis is the identification of the top 5 customers who make the highest purchases, allowing for a better understanding of customer preferences and spending habits. This insight enables the company to optimize its marketing strategies and improve customer engagement.
Furthermore, the project explores the impact of loyalty cards in tracking customer behavior across different regions within a specific timeframe. The use of loyalty cards provides several business advantages, including:
      - **Enhancing customer retention through personalized rewards and incentives.
      - **Boosting sales and revenue by encouraging repeat purchases.
      - **Improving customer experience and satisfaction through tailored promotions and exclusive offers.

**Dashboard Functionalities:**
- **Sales by Region – Analyzes total sales across different regions, identifying the top-performing locations and suggesting strategies to enhance sales in underperforming areas.
- **Top 5 Performing Customers – Highlights the highest-spending customers in various regions and by coffee type, helping businesses understand their most valuable clients and tailor promotional efforts accordingly.
- **Total Sales Over Time – Examines seasonal sales trends and time-based purchasing patterns, allowing businesses to develop short-term strategies to maximize revenue during peak seasons and improve performance during slow periods.
- **Total Sales Over Time – Examines seasonal sales trends and time-based purchasing patterns, allowing businesses to develop short-term strategies to maximize revenue during peak seasons and improve performance during slow periods.

## Project Objectives
1. **Data Cleaning - Identify and handle missing or null values to ensure data accuracy and reliability.
2. **Exploratory Data Analysis - Utilization of pivot tables for exploratory data analysis
3. **Insights and analysis - Leveraging Excel Dashboard Design for Data Analysis  and to provide key patterns, trends, and relationships within the dataset

## Project Structure:

### Data Cleaning

- **Remove blanks and Null values**: Identify Null values in data and make sure that there values are cleared.
- **Null Value Check**: Check for any null values in the dataset and delete records with missing data.
- **Remove duplicates**: Remove duplicates value to avoid inflation of figure and t maintain data accuracy.
- **Standardize Data Formatting**: Remove extra spaces using the TRIM function to ensure consistency, Retrieve data from related sources using functions like XLOOKUP and INDEX MATCH for efficient data mapping, Refine data categorization with the IF statement to standardize values within a specific column.
- **Convert Data into Tables for Easy Analysis

## Data Analysis
- **Utilization of pivot tables for data analysis and Identify KPIs 


### 3. Findings
- **Seasonal Trends - Identified sales and profit trends that align with seasonal events and market cycles, providing valuable insights for strategic business planning. These findings help optimize inventory management, promotional campaigns, and resource allocation to maximize profitability during peak seasons and mitigate downturns during slower periods.
- **Top performing Countries - The United States remains the top-performing region, followed by Ireland and the United Kingdom over a four-year period. To sustain sales in top regions, strategies like personalized promotions, loyalty programs, and supply chain optimization should be implemented. For underperforming regions (e.g., the UK), targeted marketing, customer engagement initiatives, and expanded distribution channels are key to driving sales growth.
- **Sales Volatility - Conducted an in-depth analysis of monthly sales fluctuations to identify seasonal trends, demand patterns, and potential market shifts. These insights enable data-driven decision-making, allowing the business to optimize inventory management, refine marketing strategies, and adjust sales tactics to align with changing consumer behaviors and market conditions. 


## Reports
- **The analysis reveals that the United States leads in sales over the two-year period. To drive growth, stakeholders should allocate more resources to targeted marketing campaigns in underperforming regions. Additionally, retaining existing customers in the U.S. should be a priority to sustain and further increase sales.

## Conclusion
This project offers a comprehensive guide to advanced Excel techniques for data analysts in the retail sales industry. It covers data cleaning, exploratory data analysis with pivot tables, and visualizing insights through interactive dashboards. The objective is to help retail companies enhance sales performance and refine strategies based on monthly trends and data-driven analysis.

**Dashboard Overview:** 

![CoffeeSales Dashboard](coffeeOrdersDashboard.JPG)


# Project 3

## Project Overview

**Title:** [Emergency Room Visit Dashboard](https://github.com/Dennistheanalyst/dennistheanalyst.github.io/blob/main/Hospital%20Emergency%20Room%20Visit%20Data.xlsx)

**Project Description:** This project examined hospital data to identify trends and patterns related to the daily patient stay durations in the emergency room over the course of a year, as visualized in a heat map. Furthermore, it analyzed the average patient satisfaction rates, as well as the distribution of patients based on age, gender, department referral, and race.
It gives a clear overview of key performance metrics, helping management monitor and evaluate how long patients wait in the emergency room. The dashboard offers the following functionalities:

- **Heatmap: That shows the stay duration of patients on a given day
- **Number of Patients Visiting the Emergency room.
- **Average Wait Time: The average amount of time a patient spends in the emergency room.
- **Average Satisfaction Score: This shows how satisfied patients feel after visiting the emergency room.
- **Department Referrals: The number of patients visiting a particular deopartment within a time period.
- **Patients' Race: The distribution of emergency room visits categorized by patients' race.
- **The distribution of emergency room visit categorised by age.
- **The distribution of Emergency room visit categorised by gender.
- **Additionally, the dashboard includes interactive slicers and timeline for:
- **Months/Days/Years: Apply filters to view the average wait time, the number of patients visiting the emergency room, and the average satisfaction score for a specific month, day, or year.

**Tools Used:** Microsoft Excel (Power Query for data cleaning, Coditional Formating, Pivot Tables, Slicers, Pivot Charts, Timeline, shapes, Shape format)

## Project Objectives
1. **Data Cleaning - Identify and handle missing or null values to ensure data accuracy and reliability.
2. **Exploratory Data Analysis - Utilization of pivot tables for exploratory data analysis
3. **Insights and analysis - Leveraging Excel Dashboard Design for Data Analysis  and to provide key patterns, trends, and relationships within the dataset

## Project Structure:

### Data Cleaning

- **Remove blanks and Null values**: Identify Null values in data and make sure that there values are cleared.
- **Null Value Check**: Check for any null values in the dataset and delete records with missing data.
- **Remove duplicates**: Remove duplicates value to avoid inflation of figure and t maintain data accuracy.
- **Standardize Data Formatting**: Remove extra spaces using the TRIM function
- **Convert Data into Tables for Easy Analysis

## Data Analysis
- **Utilization of pivot tables for data analysis and Identify KPIs 


### 3. Findings
- **Average Satisfaction score - The analysis reveals an average satisfaction score of 5.45/10, indicating that patient satisfaction with emergency room wait times is slightly above average. This suggests that, overall, patients are reasonably satisfied with their waiting experience.
- **Average wait time - The analysis shows that, on average, patients wait approximately 35.03 hours in the emergency room before receiving treatment.
- **Patients wait Time - identifies the number of hours patients wait in the emergency room
- **Patients Demographics - Identify the number of customers based on gender, race annad agae visiting the emergency room

## Reports
- **The average time a customer waits in the emergency room is 35.26 within the 2year period. The average wait time increased from 35.03 to 35.47 between 2019 and 2020. Reason for the increase is due to the increase in the overall population of patients visiting emergency room.
- **Over the two-year period, the heatmap reveals that patients experience wait times of up to 40 hours before receiving treatment. This highlights a critical issue that requires attention. To mitigate these extended wait times, deploying additional nurses and medical personnel is essential.
The heatmap visually represents wait times using deep blue for prolonged delays and dark gray for shorter wait times. Addressing these peak-period bottlenecks should be a priority for stakeholders to enhance efficiency and improve patient satisfaction.
- **The heatmap highlights monthly variations in patient wait times, providing valuable insights into fluctuations across different months. By analyzing these trends, stakeholders can identify peak periods and adjust strategies accordingly to minimize emergency room wait times. This proactive approach ensures better resource allocation, improving patient flow and overall healthcare efficiency.


## Conclusion
This project provides a comprehensive guide to advanced Excel techniques for data analysts in the healthcare industry. It covers data cleaning in Excel, exploratory data analysis using pivot tables, and presenting findings through interactive dashboards. The goal is to help healthcare facilities enhance patient satisfaction and ensure equitable treatment across diverse patient demographics.

**Dashboard Overview:** 
![Hospital_ER_Visit_Dashboard](Hospital_ER_Visit_Dashboard.JPG)



# SQL PROJECTS

# Project 1

## Project Overview

[reatail_sales_sql_dataset](https://github.com/Dennistheanalyst/dennistheanalyst.github.io/blob/main/Retail_sales_sql_Dataset.xlsx)

**Title:** Optimizing Retail Sales Insights: A SQL Data Analysis Project

This project showcases essential SQL skills and techniques commonly used by data analysts to explore, clean, and analyze retail sales data. It involves creating a retail sales database, conducting exploratory data analysis (EDA), and using SQL queries to answer key business questions. Designed for beginners in data analysis, this project helps build a strong foundation in SQL while providing hands-on experience with real-world data.

## Project Objectives
1. **Retail Sales Database Setup – Create and populate a structured retail sales database using the provided dataset.
2. **Data Cleaning – Identify and handle missing or null values to ensure data accuracy and reliability.
3. **Exploratory Data Analysis (EDA) – Conduct basic analysis to understand key patterns, trends, and relationships within the dataset.
4. **Business Insights & Analysis – Utilize SQL queries to address specific business questions, extract meaningful insights, and support data-driven decision-making.

## Project Structure:

### 2. Data Exploration & Cleaning

- **Record Count**: Determine the total number of records in the dataset.
- **Customer Count**: Find out how many unique customers are in the dataset.
- **Category Count**: Identify all unique product categories in the dataset.
- **Null Value Check**: Check for any null values in the dataset and delete records with missing data.

```sql
SELECT *
FROM [dbo].[Retail_sales]
WHERE [transactions_id] IS NULL

SELECT *
FROM [dbo].[Retail_sales]
WHERE [transactions_id] IS NULL
OR
[sale_date] IS NULL
OR
[sale_time] IS NULL
OR
[customer_id] IS NULL
OR
[gender] IS NULL
OR
[category] IS NULL
OR
[quantiy] IS NULL
OR
[price_per_unit] IS NULL
OR
[cogs] IS NULL
OR
[total_sale] IS NULL;

DELETE FROM [dbo].[Retail_sales]
WHERE [transactions_id] IS NULL
OR
[sale_date] IS NULL
OR
[sale_time] IS NULL
OR
[customer_id] IS NULL
OR
[gender] IS NULL
OR
[category] IS NULL
OR
[quantiy] IS NULL
OR
[price_per_unit] IS NULL
OR
[cogs] IS NULL
OR
[total_sale] IS NULL;

SELECT *
FROM [dbo].[Retail_sales]

SELECT COUNT(*)
FROM [dbo].[Retail_sales]
```

### DATA ANALYSIS AND FINDINGS:

**SQL Code:** 
1. **Write a SQL query to retrieve all columns for sales made on '2022-11-05**:

```sql
SELECT *
FROM [dbo].[Retail_sales]
WHERE  [sale_date] = '2022-11-05';
```

2. **Write a SQL query to retrieve all transactions where the category is 'Clothing' and the quantity sold is more than 4 in the month of Nov-2022**:

```sql
SELECT *
FROM [dbo].[Retail_sales]
WHERE [category] = 'Clothing'
AND 
[quantiy] >= 4
AND
YEAR([sale_date]) = '2022'
AND 
MONTH([sale_date]) = '11';
```

3. **Write a SQL query to calculate the total sales (total_sale) for each category.**:

```sql
SELECT [category], SUM([total_sale])
FROM [dbo].[Retail_sales]
GROUP BY [category]
```

4. **Write a SQL query to find the average age of customers who purchased items from the 'Beauty' category.**:

```sql
SELECT ROUND(AVG([age]),2) AS Avg_age
FROM [dbo].[Retail_sales]
WHERE [category] = 'Beauty';
```

5. **Write a SQL query to find all transactions where the total_sale is greater than 1000.**:

```sql
SELECT *
FROM [dbo].[Retail_sales]
WHERE [total_sale]>1000;
```

6. **Write a SQL query to find the total number of transactions (transaction_id) made by each gender in each category.**:

```sql
SELECT [gender],[category], COUNT([transactions_id]) AS [transactions_id]
FROM [dbo].[Retail_sales]
GROUP BY [gender],[category]
ORDER BY [category]
```

7. **Write a SQL query to calculate the average sale for each month. Find out best selling month in each year**:

```sql
WITH monthlysales AS 
(
SELECT 
		YEAR([sale_date]) AS Year,
		MONTH([sale_date]) AS Month, 
		AVG([total_sale]) AS avg_sales,
		SUM([total_sale]) AS total_sales,
		RANK() OVER(PARTITION BY YEAR([sale_date]) ORDER BY AVG([total_sale]) DESC) AS Rank
		FROM [dbo].[Retail_sales]
		GROUP BY YEAR([sale_date]),MONTH([sale_date])
	)

SELECT  Year,
Month,
avg_sales
FROM monthlysales
WHERE Rank = 1;
```

8. **Write a SQL query to find the top 5 customers based on the highest total sales **:

```sql
SELECT TOP 5 [customer_id], SUM([total_sale]) AS Total_sales
	FROM [dbo].[Retail_sales]
	GROUP BY [customer_id]
	ORDER BY Total_sales DESC;
```

9. **Write a SQL query to find the number of unique customers who purchased items from each category.**:

```sql
SELECT  COUNT(DISTINCT [customer_id]) AS Customers, [category]
FROM [dbo].[Retail_sales]
GROUP BY [category];
```

10. **Write a SQL query to create each shift and number of orders (Example Morning <12, Afternoon Between 12 & 17, Evening >17)**:

```sql
WITH hourly_sales AS (
SELECT *,
CASE 
	 WHEN DATEPART(HOUR, [sale_time]) <= 12 THEN 'Morning'
	 WHEN DATEPART(HOUR, [sale_time]) BETWEEN 12 AND 17 THEN 'AFTERNOON'
	 ELSE 'Evening' END AS Shift
FROM [dbo].[Retail_sales]
)
SELECT 
Shift,
COUNT([transactions_id]) AS total_orders
FROM hourly_sales
GROUP BY Shift;
```




### 3. Findings

- **Customer Demographics – The dataset features customers from diverse age groups, with purchases spanning various categories like Clothing and Beauty.
- **High-Value Transactions – A significant number of transactions exceed $1,000, highlighting premium purchases.
- **Sales Trends – Monthly sales analysis reveals fluctuations in demand, helping pinpoint peak seasons.
- **Customer Insights – Identifies top-spending customers and the most popular product categories, providing valuable business intelligence.

## Reports

- **Sales Summary: A detailed report summarizing total sales, customer demographics, and category performance.
- **Trend Analysis: Insights into sales trends across different months and shifts.
- **Customer Insights: Reports on top customers and unique customer counts per category.

## Conclusion

This project offers a thorough introduction to SQL for aspiring data analysts, covering key areas such as database setup, data cleaning, exploratory data analysis (EDA), and business-focused SQL queries. The insights gained from this project provide valuable information on sales trends, customer behavior, and product performance, which can support informed business decision-making.

**Technology Used:** SQL server


# Project 2

## Project Overview

[Netflix_Dataset](https://github.com/Dennistheanalyst/dennistheanalyst.github.io/blob/main/Netflix%20Dataset.xlsx)

**Title:** Interrogating data on NETFLIX

**Project Description:** This project analyzes company data to extract key information based on management's requests. It utilizes functions like COUNT and SUM to determine the total number of pizzas sold and ordered within a specific period. The SUM function is also applied to calculate the total revenue generated from pizza sales. Additionally, clauses such as WHERE, BETWEEN, IN, and WHEN are used to filter the data for specific products or product ranges as requested by the company.

## Project Objectives

- **Analyze the distribution of content types (movies vs TV shows).
- **Identify the most common ratings for movies and TV shows.
- **List and analyze content based on release years, countries, and durations.
- **Explore and categorize content based on specific criteria and keywords.

## Project Structure:

### Data Input and simple data Exploration

```sql
USE [Netflix_db]
GO

SELECT [show_id]
      ,[type]
      ,[title]
      ,[director]
      ,[cast]
      ,[country]
      ,[date_added]
      ,[release_year]
      ,[rating]
      ,[duration]
      ,[listed_in]
      ,[description]
  FROM [dbo].[netflix_titles$]

GO


SELECT 
	COUNT(*) AS Total_Content
FROM [dbo].[netflix_titles$];

SELECT *
FROM [dbo].[netflix_titles$];

SELECT DISTINCT [type]
FROM [dbo].[netflix_titles$];

SELECT DISTINCT [director]
FROM [dbo].[netflix_titles$];
```


### DATA ANALYSIS AND FINDINGS:

**SQL Code:** 

- **Count the number of movies VS TV series
  
```sql
SELECT [type], 
		COUNT(*) AS total_content
FROM [dbo].[netflix_titles$]
GROUP BY [type];
```

- **Find the most common rating for movies and TV series

```sql
SELECT [type],
	[rating],
	COUNT(*) AS No_ratings,
	RANK() OVER(PARTITION BY [type] ORDER BY COUNT(*) DESC) AS Ranking
FROM [dbo].[netflix_titles$]
GROUP BY [type],[rating];
```

- **List all movies released in a specific year(eg, 2020)
  
```sql
SELECT *
FROM [dbo].[netflix_titles$]
WHERE [type] = 'Movie' 
AND
[release_year] = 2020;
```


- **Find the top 5 countries with the most content on Netflix
  
```sql
SELECT TOP 5 [country], 
COUNT([show_id]) AS Total_content
FROM [dbo].[netflix_titles$]
CROSS APPLY string_split([country],',')
GROUP BY [country] 
ORDER BY COUNT([show_id]) DESC;
```

- **Identify the longest movie or TV show duration

```sql
SELECT *
FROM [dbo].[netflix_titles$]
WHERE [type] = 'Movie' AND 
						[duration] = (SELECT MAX([duration] )
						FROM [dbo].[netflix_titles$]);
```

- **Find content added in the last 5years

```sql
SELECT *
FROM [dbo].[netflix_titles$]
WHERE [date_added] >= DATEADD(YEAR,-5,GETDATE())

SELECT DATEADD(YEAR,-5,GETDATE());
```

- **Find all the movies or TV shows by director 'A. L. Vijay'

```sql
SELECT *
FROM[dbo].[netflix_titles$]
WHERE [director] LIKE '%A. L. Vijay%';
```

- **List all TV show with more than 5 seasons

```sql
WITH CTE AS (SELECT *,
 CAST(LEFT([duration],CHARINDEX(' ',[duration])-1) AS int) AS 'Season_Count'
FROM [dbo].[netflix_titles$]
WHERE [type] = 'TV Show' )
SELECT *
FROM CTE
WHERE Season_Count > 5;
```

- **Count the number of content items in each genre

```sql
SELECT COUNT([show_id]) AS no_of_content,  TRIM(value) AS listed_in2
FROM [dbo].[netflix_titles$]
CROSS APPLY string_split([listed_in], ',')
GROUP BY TRIM(value);
```

- **Find each year and the average number of content released by India on netflix. Return the top 5 year with the highest average content released

```sql
WITH CTE AS (SELECT DATEPART(YEAR, [date_added]) Year_1,COUNT([show_id]) AS no_of_content,[country]
FROM [dbo].[netflix_titles$]
WHERE [country] = 'India'
GROUP BY DATEPART(YEAR, [date_added]),[country])

SELECT TOP 5 
	CTE.[country],
	CTE.Year_1,
	CTE.no_of_content,
	ROUND(CAST(CTE.no_of_content AS FLOAT)/(SELECT COUNT([show_id]) FROM [dbo].[netflix_titles$] WHERE [country] = 'India' ),2) AS Current_ratio
FROM CTE
ORDER BY no_of_content DESC;
```

- **List all the movies that are documented

```sql
WITH CTE AS (SELECT *,TRIM(value) AS LISTED_IN2
FROM [dbo].[netflix_titles$]
CROSS APPLY string_split([listed_in],','))

SELECT *
FROM CTE
WHERE [type] LIKE '%Movie%' AND LISTED_IN2 LIKE '%Documentaries%';
```

- **Find all content without a director

```sql
SELECT *
FROM [dbo].[netflix_titles$]
WHERE [director] IS NULL;
```

- **Find how many movies actor 'Salman Khan' appeared in last 10 years

```sql
SELECT [type], COUNT([cast])
FROM [dbo].[netflix_titles$]
WHERE [cast] LIKE '%Salman Khan%' AND [type] = 'Movie' AND [date_added] > DATEADD(YEAR,-10,GETDATE())
GROUP BY [type];
```

- **Find the top 10 actors who have appeared in the highest number of movies produced in India.

```sql
WITH CTE AS (SELECT *,TRIM(VALUE) AS CAST2
FROM [dbo].[netflix_titles$]
CROSS APPLY string_split([cast], ',')
WHERE [type] = 'Movie')

SELECT TOP 10 CAST2, [type] , COUNT(CAST2)
FROM CTE  
GROUP BY CAST2,[type]
ORDER BY COUNT(CAST2) DESC;
```

- **Categorise the content based on the present of the keywords 'kill' and 'violence' in the description field. Label content containing these keywords as 'Bad' and all other content as 'Good'. Count how many items fall into each category.

```sql
with cte as (SELECT *,
CASE 
	WHEN  [description] LIKE '%kill%' OR 
	[description] LIKE '%violence%' THEN 'Bad Films' 
	ELSE 'Good Films'  END AS 'Films'
FROM [dbo].[netflix_titles$])

SELECT Films, COUNT(*) AS no_films
FROM cte
GROUP BY Films;
```

### Findings

- **Content Distribution: The dataset features a wide selection of movies and TV shows spanning different genres and ratings.
- **Common Ratings: Analyzing the most common ratings offers valuable insights into the target audience for Netflix's content.
- **Geographical Insights: The leading countries and India's average content releases provide insights into regional content distribution.
- **Content Categorization: Organizing content by specific keywords provides insights into the types of content available on Netflix.


## Conclusion

This analysis offers valuable insights into Netflix's content, helping to guide strategic decisions and content planning.


**Technology used:** SQL server


# Project 3
**Title:** Interrogating data(JOINS)

**Project Description:** This project analyzes company data to extract key information based on management's requests. It utilizes the JOIN statement to combine multiple tables to provide report for management based on companys request. 
Additionally, clauses such as WHERE, BETWEEN, IN, and WHEN are used to filter the data that are specifically requested by the company.

## Project Objectives

- **Extract specific customer and salesperson details based on location.
- **Retrieve information by joining multiple tables like salesman, customer, and orders.
- **Retrieve information by joining multiple tables (salesman, customer, orders)
- **Generate reports on orders, salespersons, and commissions.
- **Generate Cartesian products to analyze all possible salesperson-customer pairings.


## Project Structure:

###  Data Cleaning
- **Removing Null Vallues
- **Replacinin a null value with a figure(100)

```sql
SELECT *
FROM [dbo].[Orders]
WHERE [Order Number] IS NULL;

DELETE [dbo].[Orders]
WHERE [Order Number] IS NULL;

UPDATE [dbo].[Customers]
SET [Grade] = 100
WHERE [Grade] IS NULL;
```

### DATA ANALYSIS:

**SQL Code:** 

- **write a SQL query to find those orders where the order amount exists between 500 and 2000. Return ord_no, purch_amt, cust_name, city.
```sql
  SELECT O.[Order Number],O.[Purchase_Amount],C.[Customer_Name],[City]
FROM [dbo].[Orders] O
JOIN [dbo].[Customers] C
	ON O.[Customer ID] = C.[Customer_ID]
WHERE [Purchase_Amount] BETWEEN 500 AND 2000
```
- **Write a SQL statement to join the tables salesman, customer and orders so that the same column of each table appears once and only the relational rows are returned. 
```sql
SELECT *
FROM [dbo].[Salesmans] S
JOIN [dbo].[Customers] C
	ON S.[Salesman_id] = C.[Salesman_ID]
JOIN [dbo].[Orders] O
	ON O.[Salesman_id] = S.[Salesman_id]
```
- **Write a SQL statement to generate a report with the customer name, city, order no. order date, purchase amount for only those customers on the list who must have a grade and placed one or more orders or which order(s) have been placed by the customer who neither is on the list nor has a grade.
```sql
SELECT C.[Customer_Name],C.[City],O.[Order Number],O.[Order Date],O.[Purchase_Amount]
 FROM [dbo].[Customers] C
 LEFT JOIN [dbo].[Orders] O
	ON C.[Customer_ID] = O.[Customer ID]
	WHERE ([Customer_ID] IS NOT NULL
	AND [Grade] IS NOT NULL)
	OR (C.[Customer_ID] IS NOT NULL
	OR C.[Grade] IS NOT NULL)
```
- **Write a SQL statement to create a Cartesian product between salesperson and customer, i.e. each salesperson will appear for every customer and vice versa for those salesmen who belong to a city and customers who require a grade.
```sql
SELECT *
FROM [dbo].[Salesmans] S
JOIN [dbo].[Customers] C
ON S.[city] = C.[City]
WHERE C.[Grade] IS NOT NULL;
```

## Conclusion 
Based on managements request I was able to fetch these information for their consumption using JOINS.


# POWER BI PROJECT

# Project 1

**Title:** [Hospitality Industry Dashboard](https://github.com/Dennistheanalyst/dennistheanalyst.github.io/blob/main/Hospitality%20industry%20project.pbix)

**Tools Used:** Power BI, Power Query, DAX functions, Charts, Shapes, Slicers.

**Project Description:** This project analyzed data from the hospitality sector to uncover trends and patterns in sales performance, guest stay durations by month, and the most popular booking channels. Additionally, it examined the demographic profile of visitors, including the count of children and adults throughout the year. The analysis also explored the average rates of different room types and the average rates by week.
It provides a detailed overview of essential performance metrics, enabling stakeholders to effectively track and assess the company’s performance across various metrics. The dashboard offers the following functionalities:

Number of Adults: The total count of adults who stayed at the hotel over the course of the year.

Number of Children: The total number of children who stayed at the hotel during the year.

Total Revenue: The overall revenue earned throughout the year.

Average Revenue: The yearly average revenue generated.

Number of Adults per booking Channel: Number of adults that uses various booking channels to book the hotel.

Number of Children Per Booking Channel: Number of Children that uses various booking channels to book the hotel.

Average Room Rate by week: Average price of the room by week be it weekend or weekday.

Average room rate by room type: The average rates of different room types offered at these hotels.

Stay Duration by month: This considers the length of time hotel patrons stay throughout the year.

Additionally, the dashboard includes interactive slicers and timeline for:

Months:  Filter the data to view performance for a specific month or range of months.

**Key findings:** Channel Optimization: Identifies key channels the company should prioritize to enhance customer service and improve performance across other booking channels.

Seasonal Patterns: Analyzes the months when customers tend to stay longer at the hotels, enabling the company to optimize profitability and deliver exceptional customer service.

Sales Volatility: Analyzed monthly sales fluctuations to understand market dynamics and adjust business strategies accordingly.

**Dashboard Overview:** 
![hospitality_industry_dashboard](hospitality_industry_dashboard.JPG)


